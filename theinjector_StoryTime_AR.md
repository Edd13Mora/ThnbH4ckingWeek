# كيفاش قدرت نهاكي كاميرة المراقبة ديال صاحبي و ندير ليه برانك خطير!

ياو واش ادراري كلشي مزيان أول حاجة كنبغي نشكر دراري لي دارو هاد لكونسيبط و على كاع المجهودات لي كيقدمو.


❗❗قبل منبداو هاد سطوري راني خديت الإذن من عند هاد الصديق لي غنعاود القصة ديالي معاه.


نبداو سطوري تايم واحد المرة عيط ليا واحد لعشير  فرمضان على أساس نفطر معاه بلا مندكرو سمية المدينة اوا اسيدي مشيت انا و واحد صاحبي لعندو كيف وصلنا كيبان ليا دار واحد الكاميرة حدا واحد الشرجم ديالو مي مكاين لا كابليات لا والو اول سؤال جاني فبالي بلي هادي كاميرا sans  fil و 100% فيها بلاصت الكارت ميموار يعني اي حاجة كتسجل ف كارت ميموار.

![Logo](https://i.imgur.com/ueDOHbE.jpg)

 معلينا انا مزال فطموبيل جبدت بيسي كندير سكان كنلقا بزاف الويفيات و ميمكنش نعرف الويفي تاعو فغادي نضيع الوقت فيهم و قلت مع راسي ممكن يكون ممدخلش ليها الويفي يعني تكون تسجل غير ب كارت ميموار اوا معلينا سد هاد البيسي حتى نشوف شي بلان باش نشد فيه مزيان. طلعنا ستقبلنا فطرنا خرجنا و و رجعنا بليل شديت ستون ماقلت ليه لا بغيت ويفي لا والو باش فلخر ميقولش ليا را انا لي عطيتك لكود هههه المهم جبدت درت محاولة مع الويفي ب waircut لي بزاف كي عرفوها و طلعت ليا غير pin فتحت jumpstart ودخلت بين و سبيسيفيت الويفي ديالو غادي يتكونكطا اول حاجة مشيت كندير سكان على داك network نعرف شنو فيه
```
nmap -sC -sV -Pn 192.168.1.0/24
```
 لقيت واحد ip لي فيه تقريبا واحد 7 ديال لي بور كلهم محلولين و انا كندير هداشي و داوي معاه باش ميردش لبال لقيت بور من بعد ما سالا سكان
```
PORT     STATE SERVICE
23/tcp   open  telnet
80/tcp   open  http
554/tcp  open  rtsp
843/tcp  open  unknown
3201/tcp open  unknown
5050/tcp open  mmcc
8001/tcp open  vcom-tunnel
```

من بعد ماسالات nmap مشيت قلبت على هاد الكاميرا لي كنت متأكد أنها هي غير من لي بور
لقيت
```
Device Specification: Cacagoo IP camera
Device Name: CACAGOO Cloud Storage Intelligent Camera
Model: TV-288ZD-2MP
Manufacture: Shenzhen TOMTOP Technology Co., Ltd.
Firmware Version: 3.4.2.0919
Application: YCC365 plus
Application Version: 3.1042.9.8733
Manufacturer Mailing Address: G-4 Zone 5/F, No.1 Exchange Square, Huanan City, Pinghu Town Longgang District, Shenzhen, Guangdong, China
Email Address: support@cacagoo.com
Importer name: FISHING KING, SLU
Importer Address: PIEDRABUENA,4,4B, MADRID,28026 Spain
```
 هادو لي كانو كي هموني اول حاجة مشيت خديت هاد ip جربتو ف browser لقيت باج اندكس مافيها والو كندير داك ايبي و كنزيد
8001
```
http://192.168.1.103:8001
```
والو نفس الشيء مشيت قلبت على ديك سمية ديال سيرفيس لي طلعتها ليا nmap  لقيت واحد WEBUI لي كانت فواحد versions قدامين بزاف مصدقاتش فهادي مني بقيت كنقلب لقيت باش نجرب بلي كاميرا خدامة خاص نزيد ورا داكي ايبي snapshot يعني غايولي الايبي هاكا
```
http://192.168.1.103:8001/snapshot
```
هاد lien كي دخل بلا user وبلا باسوورد و كل مرة كندير رفريش كنلقا الصورة كتحرك يعني داكشي خدام ناضي كاناضي هههه بزاف حتى لهنا مزيان مشيت زدت قلبت على هاد كاميرا لقيت بزاف كيهدرو عليها و كانو بزاف يوزرات و باسووردات ديال telnet حاطينهم منهم
```
admin 12345
admin cxlinux
```
![Logo](https://i.imgur.com/jaykVj7.png)

جربتهم والو مشيت شفت بور اخور لي هوا rtsp
Real time streaming protocol
وهاد البروتوكول كي خلينا ببساطة نشوفو الكاميرا لايف و من مختلف الأجهزة من بعد مشيت vlc لي كلشي كي عرفو و مشيت open media من بعد network و درت lien لي كان عندي بدلت بروتوكول http ب rtsp


![Logo](https://i.imgur.com/to8Iv0A.png?1)



```
 - rtsp://192.168.1.103:8001
```
من بعد كليكيت enter
![Logo](https://i.imgur.com/bFdHOAx.png)

و ها هي تحلات الكاميرا ههههه وداك لعشير لقيتو شاد ستون كي تفرج مشيت دخلت ل راوتر
192.168.1.1 لقيتو مخلي admin admin
![Logo](https://i.imgur.com/OJc06OQ.png)
دخلت فيكيسيت ايبي ديال كاميرا ب ادريس ماك ديالها باش ميبقاش فينما يطفي الويفي تبدل لي ديك ادريس من بروتوكول dhcp
معلينا مشيت كنزيد نقلب كنزيد نقلب كنلقا فيها واحد شانيل hd و شانيل اخرى hd و بالصوت هههه واضفاك لقيتها هي
```
rtsp://192.168.1.103:8001/0/av1   
```

كنرجع vlc كنديرها كنسمع دراري كي هضرو لتحت و البيبان ديال طموبيلات لي كيتسدو كان عندها واحد المايك ميمكنش مني زدت قلبت كنلقا واحد يورز آخر لي هو root و باسوورد cxlinux وراكم عارفين بلي ب روت اش تقدر دير جربت  
```
telnet 192.168.1.103
```
```
username:root
password:cxlinux
وكنت لقيت شي كاميرات من هاد النوع لي تقدر دخل رووت بلا باسوورد
Camera TV-288ZD-2MP with firmware 3.4.2.0919
CVE-2020-6852
```
BOOOM!!!

وات وايلي دخل روت؟ بقيت كنضحك هاد لعشير غادي نسطيه هاد ليلة كنفكر فشي بلان قلتها لداك صاحبي لي كان معايا ف واتساب بقا كيضحك وكيفكر فشي prank نديروه ليه بقيت كنقلب فكاع folders كنحاول نشوف اشنو كاين تما فلخر كندخل ل دوصي mnt ب
```bash
cd /mnt
ls -la
mmc0
cd mmc0 && ls -la
0
cd 0 && ls -la
```
![Logo](https://i.imgur.com/wibBuFe.png)

كنلقا اخر ضوصي هو داك 0 كي تسجلو فيه كاع الفيديووات لي بطبيعة الحال ف كارت ميموار لي مونتيا تما طاحت عليا واحد الفكرة كاع دوك ضواصا رجعتهوم hidden يعني مكيبانوش رجعتهوم كيبداو ب . نقطة باش يوليو كاشي
```
wpa_supplicant.conf
```
وهاد الفيشي فيه configuration ديال الويفي ديالو باش الكاميرا تكون interface ديالها مكونيكطيا معا الويفي كتقاد ف البدية د installation ديالها

![Logo](https://i.imgur.com/eG4wgN6.png)


اوا يا سيدي خليتو حتى نعس على خاطرو و هزيت كونطاك ديالو و هبطت بدلت بلاصت طوموبيل.

![Logo](https://i.imgur.com/LOVM5C7.png)


 و خليتو حتى لصباح  مع 7 فاق بدا غادي انا و داك صاحبي كنبقاو صهرانين بزاف فاق لقانا مزال فايقين هبط مبانتش ليه طموبيل رجع كي جري وحنا شفناه من balcon رجع فواحد الحالة مصدوم هههههههه رجع الكاميرا حدا سرجهم جبد كارت ميموار و معصب  دارها ف تيليفون كيدخل مكيلقا والو هههههههه اواه اش هادشي واضفاااك بان ليا  غايولي ساخف لينا تما بديت ليه القصة من لخر وريتو طموبيل فين كاينا و عاودتلو لبلان من لول حتى اللخر بقا شاد راسو معرف يبكي و لا يضحك من هاد المنبر كنعاود نقوليك سمحليا غير ضحكنا معاك هههههه و من تما بدا هاد صاط كيعز عليه هاد ضومين و ولا عندو شغف يعرف كيفاش يتعلم و لو شي حوايج لي كي بانولينا بساط بززاف.
من بعد وريتو كيفاش يقدر يبقا يشوفها ا ديستونس لي مكانش عارفها و دخلت لي app ف تيليفون ديالو و ريتو كيفاش يشوفها من بيسي حتى هو و درت ليه واحد no-ip و فتحت ليه بورت ف روتور من تما بقا كيقدر يشوف كاميرا فينما كان

و الخاتمة متخليش اي بور مخدامش بيه ديما محلول و بما أن الناس لي ماشي فضومين مكتعرفش بزاف حاولو تسولو ناس و لا تقلبو راسكم و لا شي حاجة هاكا بحال فهاد الحالة كان اول خطوة تكون wps طافيا ف روتور و يكون باسوورد قوي من ارقام و حروف و رموز باش يصعب التخمين عليه و يتبدل باسوورد ديال بانل و تأكد ان معندكش شي حساب noip ولا dyndns لا يكون ديجا شي واحد مهاكيك ثاني حاجة يكون بور ديال telnet مسدود تالث حاجة ميكونش نفس الباسوورد لي كتجي بيه الكاميرا و حاجة اخرى تشوف شي حد مختص باش يفيكسي ليك الضعف لي كين ف بروتوكل rtsp لي بلا authentication ولا يقترح عليك حل اخر واجب على اي واحد يراقب بحال هاد المسائل قبل الوقوع في أيادي غير آمنة.
